import mongoose from "mongoose"

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• MongoDB
export const connectToDB = async () => {
    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏≠‡∏ö‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
    const connection = {}
    // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£ connection ‡∏à‡∏≤‡∏Å mongoose: https://mongoosejs.com/docs/connections.html
    try {
        if (connection.isConnected) return;
        // ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• MongoDB ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ô‡∏ö‡∏ô localhost ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏∑‡πà‡∏≠ 'test'
        // Connect to Cluster0
        const db = await mongoose.connect(process.env.MONGO);
        // console.log('debuging db :', db);

        // ‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ connection ‡πÇ‡∏î‡∏¢‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á connection[0]
        connection.isConnected = db.connections[0].readyState;
    } catch (error) {
        console.log(error);
        // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô ‡∏à‡∏∞‡πÇ‡∏¢‡∏ô error ‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ
        throw error; // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏à‡∏≤‡∏Å 'new (error)' ‡πÄ‡∏õ‡πá‡∏ô 'error'
    }
};

export function formatDateToThai(dateString) {
    const date = new Date(dateString);
    console.log('This is dateString üåé ', dateString);
    const day = String(date.getDate()).padStart(2, '0');
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const year = date.getFullYear() + 543; // ‡πÄ‡∏û‡∏¥‡πà‡∏° 543 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏µ ‡∏û.‡∏®.
    return `${day}/${month}/${year}`;
}